<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AIDOME 데이터 관리</title>
  <link rel="icon" href="/static/favicon.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <main class="container">
    <div class="topbar">
      <h1>데이터 관리 콘솔</h1>
      <div class="row">
        <a class="link-btn" href="/company-search">업체검색</a>
        <a class="link-btn" href="/">전략 수립</a>
        <a class="link-btn" href="/admin">운영 콘솔</a>
        <button id="logoutBtn" type="button">로그아웃</button>
      </div>
    </div>

    <section class="card">
      <h2>운영 대시보드</h2>
      <div class="kpi-grid">
        <div class="kpi-card">
          <span class="kpi-label">인덱스 상태</span>
          <strong id="kpiIndexLoaded">-</strong>
        </div>
        <div class="kpi-card">
          <span class="kpi-label">인덱스 청크 수</span>
          <strong id="kpiChunkCount">-</strong>
        </div>
        <div class="kpi-card">
          <span class="kpi-label">뉴스 파일 수</span>
          <strong id="kpiNewsCount">-</strong>
        </div>
        <div class="kpi-card">
          <span class="kpi-label">최종 업데이트</span>
          <strong id="kpiUpdatedAt">-</strong>
        </div>
      </div>
    </section>

    <section class="card">
      <h2>공시 데이터 대량 수집</h2>
      <div class="row wrap">
        <button id="disclosureStartBtn" type="button">실행</button>
        <button id="disclosureStopBtn" class="ghost-btn" type="button">중지</button>
      </div>
      <label for="disclosureProgressBar">진행률</label>
      <progress id="disclosureProgressBar" max="100" value="0" style="width: 100%;"></progress>
      <pre id="disclosureStatusView">아직 실행 없음</pre>
    </section>

    <section class="card">
      <h2>업체</h2>
      <div class="row wrap">
        <label>
          업체명
          <input id="commonCompanies" type="text" value="" placeholder="예: BYC, 삼성전자, 001460.KS" />
        </label>
      </div>
      <p class="muted">대량 수집을 제외한 작업은 업체 기준으로 수행합니다.</p>
    </section>

    <section class="card">
      <h2>AI 업체검색</h2>
      <div class="row wrap">
        <label>
          검색 프롬프트(선택)
          <textarea id="adminAiSearchPrompt" rows="4" placeholder="비워두면 업체명 기준으로 검색"></textarea>
        </label>
      </div>
      <div class="row wrap">
        <label>
          TXT 파일 첨부(선택)
          <input id="adminAiSearchTxtFile" type="file" accept=".txt" />
        </label>
        <label>
          템플릿
          <select id="adminAiSearchTemplate">
            <option value="company_overview" selected>기업 개요 분석</option>
            <option value="industry_market_analysis">산업 및 시장 분석</option>
            <option value="valuation_analysis">밸류에이션 관련</option>
            <option value="due_diligence_risk_analysis">리스크 및 실사</option>
            <option value="strategic_decision_analysis">전략적 의사결정</option>
            <option value="synergy_pair_analysis">두 회사간 시너지 분석</option>
          </select>
        </label>
        <label>
          AI Provider
          <select id="adminAiSearchProvider">
            <option value="gemini" selected>gemini</option>
            <option value="openai">openai</option>
          </select>
        </label>
        <label>
          결과 개수
          <input id="adminAiSearchTopK" type="number" min="1" max="30" value="10" />
        </label>
      </div>
      <div class="row wrap">
        <button id="adminAiSearchRunBtn" type="button">AI 업체 검색 실행</button>
        <button id="adminAiSearchRegisterBtn" type="button">AI 결과 DB 등록</button>
      </div>
      <p>검색 결과</p>
      <pre id="adminAiSearchResultView">아직 요청 없음</pre>
      <p>프롬프트</p>
      <pre id="adminAiSearchPromptView">아직 요청 없음</pre>
      <p>AI 결과</p>
      <pre id="adminAiSearchRawView">아직 요청 없음</pre>
    </section>

    <section class="card">
      <h2>인터넷 업체검색</h2>
      <div class="row wrap">
        <label>
          인터넷 검색 프롬프트(선택)
          <textarea id="adminInternetSearchPrompt" rows="4" placeholder="비워두면 업체명/TXT 기반 검색"></textarea>
        </label>
      </div>
      <div class="row wrap">
        <label>
          TXT 파일 첨부(선택)
          <input id="adminInternetSearchTxtFile" type="file" accept=".txt" />
        </label>
        <label>
          템플릿
          <select id="adminInternetSearchTemplate">
            <option value="company_overview" selected>기업 개요 분석</option>
            <option value="industry_market_analysis">산업 및 시장 분석</option>
            <option value="valuation_analysis">밸류에이션 관련</option>
            <option value="due_diligence_risk_analysis">리스크 및 실사</option>
            <option value="strategic_decision_analysis">전략적 의사결정</option>
            <option value="synergy_pair_analysis">두 회사간 시너지 분석</option>
          </select>
        </label>
        <label>
          <input id="adminInternetIncludeWeb" type="checkbox" checked />
          일반 웹검색 포함
        </label>
        <label>
          결과 개수
          <input id="adminInternetSearchTopK" type="number" min="1" max="30" value="10" />
        </label>
      </div>
      <div class="row wrap">
        <button id="adminInternetSearchRunBtn" type="button">인터넷 검색</button>
        <button id="adminInternetSearchRegisterBtn" type="button">검색 결과 DB 등록</button>
      </div>
      <p>검색 결과</p>
      <pre id="adminInternetSearchResultView">아직 요청 없음</pre>
      <p>프롬프트</p>
      <pre id="adminInternetSearchPromptView">아직 요청 없음</pre>
      <p>원본 결과</p>
      <pre id="adminInternetSearchRawView">아직 요청 없음</pre>
    </section>

    <section class="card">
      <h2>데이터 상태</h2>
      <button id="refreshBtn">새로고침</button>
      <pre id="statusView">로딩 중...</pre>
    </section>
  </main>
  <script src="/static/admin.js?v=20260218j"></script>
</body>
</html>
